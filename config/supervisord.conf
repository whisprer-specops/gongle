[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/tmp/supervisord.pid

[program:flask]
command=gunicorn -w 4 -b 127.0.0.1:5000 --timeout 120 --worker-class gevent --user gongle --group gongle app:app
directory=/app/gongle-web
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/gunicorn.log
environment=PATH="/usr/local/bin:/usr/bin:/bin",PYTHONPATH="/app/gongle-web:/app/integration"

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/nginx-supervisor.log

# Optional: Run Rust Theater API as HTTP service
# [program:rust-theater-api]
# command=/app/bin/theater-api --bind 127.0.0.1:8080
# directory=/app
# user=gongle
# autostart=false
# autorestart=true
# redirect_stderr=true
# stdout_logfile=/app/logs/rust-theater.log